"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15632],{515632:function(e,t,r){let n;r.d(t,{W:function(){return ry}});var i=r(706138),o=r(652983),s=r(95374),a=r(945368),l=r(394580),c=r(12984),d=r(205609),u=r(670296),p=r(590862),m=r(117339),h=r(720231),g=r(555640),f=r(397458);let y=({showResolved:e,updateFilterOptions:t})=>{let r=e=>{t({status:e?void 0:"open"})};return(0,f.jsx)(u.u,{placement:"top-start",label:e?g.T.HideResolvedComments:g.T.ShowResolvedComments,children:(0,f.jsx)(p.z,{onClick:()=>r(!e),variant:"minimal",size:"sm","aria-label":e?g.T.HideResolvedComments:g.T.ShowResolvedComments,leftIcon:e?(0,f.jsx)(m.b,{}):(0,f.jsx)(h.c,{}),children:g.T.Resolved})})};var v=r(751004),j=r(41792),b=r(939817),x=r(202958),O=r(15239),w=r(873794),C=r(406992);let P=({defaultSort:e,isPublic:t,setSort:r,onSortSelect:n})=>{let{0:i,1:s}=(0,o.useState)(e),a=[{value:"newest",label:g.T.Newest,type:"date",direction:"desc"},{value:"oldest",label:g.T.Oldest,type:"date",direction:"asc"}],l=[{value:"timecode",label:g.T.TimeCode,type:"time_code",direction:"asc"}];t||(a=[...a,...l]);let c=e=>{s(e.label);let t={value:e.value,label:e.label,type:e.type,direction:e.direction};r(t),n?.(t)};return(0,o.useEffect)(()=>{r({value:"newest",label:g.T.Newest,type:"date",direction:"desc"}),s(g.T.Newest)},[t]),(0,f.jsx)(v.xu,{children:(0,f.jsxs)(j.v,{placement:"bottom",children:[(0,f.jsx)(u.u,{label:g.T.Sort,placement:"top",children:(0,f.jsx)(b.j,{onFocus:e=>e.preventDefault(),as:p.z,variant:"minimal",size:"sm",rightIcon:(0,f.jsx)(C.W,{}),children:i})}),(0,f.jsx)(x.q,{background:"background",children:(0,f.jsx)(O._,{defaultValue:i,value:i,title:g.T.SortBy,textColor:"text-secondary",children:a.map(e=>(0,f.jsx)(w.i,{value:e.label,onClick:()=>c(e),children:e.label},e.label))})})]})})};var k=r(447218),R=r(530679),I=r(587416);let S=({filterOptions:e,updateFilterOptions:t,isLoggedOut:r})=>{let n="everyone"!=e.userType||e.mentionAndReplies;return(0,f.jsxs)(j.v,{children:[(0,f.jsx)(u.u,{placement:"top",label:g.T.Filter,children:(0,f.jsx)(b.j,{onFocus:e=>e.preventDefault(),as:k.h,variant:n?"primary":"minimal",size:"sm","aria-label":"Filter comments",icon:(0,f.jsx)(I.w,{})})}),(0,f.jsxs)(x.q,{background:"background",children:[!r&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(O._,{title:`${g.T.ShowFrom}:`,textColor:"text-secondary",defaultValue:"everyone",value:e.userType,onChange:e=>t({userType:e}),children:[(0,f.jsx)(w.i,{value:"everyone",children:g.T.Everyone}),(0,f.jsx)(w.i,{value:"team",children:g.T.OnlyFromTeam}),(0,f.jsx)(w.i,{value:"non_team",children:g.T.OnlyGuests})]}),(0,f.jsx)(R.R,{})]}),(0,f.jsx)(O._,{value:e.mentionAndReplies?.toString(),children:(0,f.jsx)(w.i,{value:"true",onClick:()=>t({mentionAndReplies:!e.mentionAndReplies}),children:g.T.MentionsAndReplies})})]})]})};var E=r(692584),T=r(29607),D=r(602156),N=r(181633),$=r(189597),_=r(35773),L=r(439136),A=r(352950),F=r(722893),z=r(926579),K=r(112756),M=r(192740),U=r(810464),Z=r(806298),V=r(439483),B=r(496751),q=r(291017),J=r(341174),H=r(275294),G=r(815325),Y=r(655167),Q=r(537897),W=r(36608),X=r(530651),ee=r(771534),et=r(729577),er=r(609150);let en=({textDecoration:e,setPreviewClip:t})=>{let r=e.assets?.video,{0:n,1:i}=(0,o.useState)(!0);return r&&(0,Z.Pd)(r.uri)?(0,f.jsxs)(v.xu,{children:[(0,f.jsxs)(l.k,{py:"4px",children:[(0,f.jsx)(d.x,{overflow:"hidden",variant:"body-md",children:`"${r.name}"`}),(0,f.jsx)(k.h,{px:"4px",ml:"4px",size:"xs",variant:"minimal","aria-label":"show-preview",onClick:()=>i(!n),icon:(0,f.jsx)(et._,{transform:`rotate(${n?0:-90}deg)`,transition:"transform 0.3s ease"})})]}),(0,f.jsx)(E.M,{children:n&&(0,f.jsxs)(l.k,{position:"relative",as:T.E.div,direction:"column",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{type:"tween"}},exit:{opacity:0,height:0},onClick:()=>{t(r)},children:[(0,f.jsx)(X.E,{src:r.pictures?.sizes?.[1]?.link,fallbackSrc:"https://i.vimeocdn.com/video/default_295x166.jpg",alt:"comment video link thumbnail"}),(0,f.jsx)(ee.M,{height:"100%",width:"100%",position:"absolute",children:(0,f.jsx)(k.h,{"aria-label":"preview-play",background:"gray.50",icon:(0,f.jsx)(er.s,{})})})]})})]}):null},ei=({setPreviewClip:e,textDecorations:t})=>(0,f.jsx)(f.Fragment,{children:t.map((t,r)=>(0,f.jsx)(en,{textDecoration:t,setPreviewClip:e},r))});var eo=r(853106),es=r(343831),ea=r(974145),el=r(274133),ec=r(462481),ed=r(242145),eu=r(855623),ep=r(855998),em=r(295152),eh=r(435746);function eg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ef(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eg(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eg(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ey=e=>{let t=0,r=[];return e.descendants((e,n)=>{if(["text","mention"].includes(e.type.name)){let i="text"===e.type.name?e.text||"":e.attrs.label;r[t]?(r[t].text+=i,r[t].nodePositions.push({pos:n,type:e.type.name,text:i})):r[t]={text:`${i}`,nodePositions:[{pos:n,type:e.type.name,text:i}]}}else t+=1}),r=r.filter(Boolean)},ev=(e,t)=>{let r=[];for(let n of Array.from(e.matchAll(t)).filter(([e])=>e.trim())){if(""===n[0])break;void 0!==n.index&&r.push({startIndex:n.index,length:n[0].length,endIndex:n.index+n[0].length})}return r},ej=(e,t)=>{let r=[],n=[];return e.forEach(e=>{let{from:i,to:o,pos:s,type:a}=e;if("text"===a){let e=eh.p.inline(s+i,s+o,{class:t,nodeName:"mark"});r.push(e)}else"mention"===a&&n.push({from:i,to:o,pos:s})}),{nonMentionResults:r,mentionResults:n}},eb=(e=null,t,r,n)=>{if(!t||!e)return{nonMentionResults:eh.EH.empty,mentionResults:[]};let i=ey(e),o=[];i.forEach(e=>{let{text:r,nodePositions:i}=e,s=ev(r,t);if(0===s.length)return{nonMentionResults:eh.EH.empty,mentionResults:[...n]};let a=r.length*s.length,l=0,c=0,d=0,u=0,p=0;for(;l<r.length&&d<i.length&&!(c>=s.length)&&!(p>a);){let e=s[c]||{},{pos:t,type:r,text:n}=i[d],a=e.startIndex+u;if(e.startIndex!==e.endIndex&&e.endIndex<=a||u>=e.length){c++,u=0;continue}if(a<l+n.length){let i=a-l,s=e.endIndex-l>n.length?n.length:e.endIndex-l;o.push({from:i,to:s,pos:t,type:r}),u+=s-i,i===s&&u++}else d++,l+=n.length;p++}});let{nonMentionResults:s,mentionResults:a}=ej(o,r);return{nonMentionResults:eh.EH.create(e,s),mentionResults:[...n,...a]}},ex=ep.hj.create({name:"searchHighlight",addOptions:()=>({searchHighlightClass:"highlighted-text"}),addStorage:()=>({searchTerm:"",mentionResults:[],lastSearchTerm:""}),addCommands:()=>({setSearchTerm:e=>({editor:t})=>(t.storage.searchHighlight.searchTerm=e,!1)}),addProseMirrorPlugins(){let e=this.editor,{searchHighlightClass:t}=this.options,r=t=>e.storage.searchHighlight.lastSearchTerm=t;return[new em.Sy({key:new em.H$("searchHighlightPlugin"),state:{init:()=>eh.EH.empty,apply({doc:n,docChanged:i},o){let{searchTerm:s,lastSearchTerm:a,mentionResults:l}=e.storage.searchHighlight;if(!i&&a===s)return o;r(s);let c=(l||[]).map(e=>ef(ef({},e),{},{from:void 0,to:void 0}));if(!s)return e.storage.searchHighlight.mentionResults=[...c],e.storage.searchHighlight.searchTerm="",eh.EH.empty;let{nonMentionResults:d,mentionResults:u}=eb(n,RegExp(String(s).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"),"gui"),t,c);return e.storage.searchHighlight.mentionResults=u,d}},props:{decorations(e){return this.getState(e)}}})]}});function eO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ew(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eO(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eO(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eC=({text:e="",editedTime:t,isResolved:r,searchQuery:n})=>{let i=(0,o.useMemo)(()=>{try{return JSON.parse(e)}catch(e){return}},[e]),s=(0,ed.jE)({editable:!1,extensions:[es.Z,ec.Z,el.Z,eo.ZP,ea.Z,ex.configure({searchHighlightClass:"highlighted-text"}),eu.Z],content:i});(0,o.useEffect)(()=>{i&&setTimeout(()=>{s?.chain().setContent(i).run()},0)},[i,s]),(0,o.useEffect)(()=>{s&&s.commands.setSearchTerm(n||"")},[n,s]),(0,o.useEffect)(()=>{if(s){let e=s.storage.searchHighlight?.mentionResults??[],t=s.state.tr;e.forEach(e=>{let{from:r,to:n,pos:i}=e,o=t.doc.nodeAt(i);t.setNodeMarkup(i,null,ew(ew({},o?.attrs),{},{highlight:{from:r,to:n}}))}),s.view.dispatch(t.setTime(Date.now()))}},[s?.storage?.searchHighlight?.mentionResults?.length]);let a=(0,o.useMemo)(()=>({".rich-comment-viewer":{display:"inline",fontSize:"text-sm",color:"text-primary"},".ProseMirror":{paddingLeft:0,display:"inline",p:{display:"inline"},".highlighted-text":{backgroundColor:"orange.100"},".highlighted-mention-text":ew({backgroundColor:"orange.100"},r?{color:"gray.900",opacity:1}:{color:"fill-brand"})}}),[r]);return s?(0,f.jsxs)(v.xu,{display:"inline",sx:a,children:[(0,f.jsx)(ed.kg,{className:"rich-comment-viewer",editor:s}),(0,f.jsx)(eP,{editedTime:t})]}):null},eP=(0,o.memo)(({editedTime:e})=>e?(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(e),children:(0,f.jsx)(d.x,{display:"inline",color:"text-secondary",variant:"body-md",children:` (${g.T.Edited})`})}):null);var ek=r(492836),eR=r(697734),eI=r(597325);let eS=({id:e,user:t,createdTime:r,editedTime:n,timeCode:i,formattedTimeCode:a,text:l,replies:c,isReply:m,onEditClick:h,onDeleteClick:y,onCopyClick:O,onReplyClick:w,isOwnComment:C,isOwnVideo:P,activeReplyId:R,isDeeplinkedComment:I=!1,isRichComment:S=!1,canAddComments:E=!0,onOpenCommentOptionsClick:T,isUserProfileClickable:N,onUserProfileClick:$,status:_,toggleCommentStatus:A,canResolveComment:F=!1,textDecorations:z,setPreviewClip:K,onMomentPlay:M,isBeingEdited:U,parentCommentId:X,searchQuery:ee,isPreviousVersion:et=!1,onReportClick:er,videoPrivacy:en,isPublic:eo})=>{let{0:es,1:ea}=(0,o.useState)(!1),el="closed"===_,[ec,ed]=(0,Z.gp)(t?.pictures?.sizes),eu=R&&R===e,ep=c&&c.length>0,em=!m&&!eu&&!U&&!ep&&E,eh=C||P,eg=C&&(E||et)&&!el,ef=function(){let e=(0,eI.R)(),t=e?.vuid??0,{assignment:r}=(0,ek.CZ)({flagKey:"video-comment-reporting",subject:{key:t,keyType:eR.B7.VUID},defaultAssignment:"control",assignmentType:eR.Ib.STRING});return r}(),ey=eo&&"anybody"===en&&!C&&void 0!==er&&"variant"===ef,ev=O&&!et,ej=(0,o.useRef)(null),eb=(0,s.pm)(),ex=()=>{$?.(e,!!m,t?.id||"")},{highlightedCommentId:eO,setHighlightedCommentId:ew}=(0,o.useContext)(W.q),eP=eO===e;(0,o.useEffect)(()=>{setTimeout(()=>(I||eP)&&ej.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),500)},[I,eP]);let eS=t?.badge,eE=(0,o.useRef)(null),{0:eT,1:eD}=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=eE.current;if(!e)return;let t=new ResizeObserver(()=>{eD(e.scrollWidth>e.clientWidth)});return t.observe(e),()=>{e&&t.disconnect()}},[eE]),(0,f.jsxs)(L.U,{spacing:75,align:"flex-start",mx:"8px",px:{base:"8px",md:"16px"},py:75,role:"group","data-testid":"comment",ref:I||eP?ej:null,onClick:()=>{i&&M(i)},id:`comment_${e.split("/").pop()}`,onMouseEnter:()=>{i&&ew(e)},onMouseLeave:()=>{i&&ew(null)},backgroundColor:eP?"fill-component-hover":"inherit",borderRadius:"md",sx:{"p, span, img, strong":{opacity:"closed"===_?.5:void 0},"strong, strong span, strong span p":{opacity:"closed"===_?1:void 0}},_hover:{cursor:i?"pointer":"default",background:"fill-component-hover"},children:[t?.link&&N?(0,f.jsx)("a",{onClick:ex,href:t?.link,"aria-label":"Link to user profile",children:(0,f.jsx)(V.q,{"data-testid":"avatar",alt:"User avatar",src:ec,srcSet:ed,size:"sm",style:{height:"2rem"}})}):(0,f.jsx)(V.q,{"data-testid":"avatar",alt:"User avatar",src:ec,srcSet:ed,size:"sm",style:{height:"2rem"}}),(0,f.jsxs)(D.g,{spacing:75,minW:0,align:"stretch",flex:1,children:[(0,f.jsxs)(L.U,{spacing:75,mb:"-8px",children:[t?.link&&N?(0,f.jsx)("a",{onClick:ex,href:t?.link,"aria-label":"Link to user profile",style:{minWidth:0},children:(0,f.jsx)(u.u,{placement:"top",isDisabled:!eT,label:t?.name,children:(0,f.jsx)(d.x,{variant:"heading-xs",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",ref:eE,color:"text-primary",children:t?.name})})}):(0,f.jsx)(u.u,{placement:"top",isDisabled:!eT,label:t?.name,children:(0,f.jsx)(d.x,{ref:eE,variant:"heading-xs",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text-primary",children:t?.name})}),"alum"===eS&&(0,f.jsx)(B.C,{size:"sm",children:g.T.Alum}),"staff"===eS&&(0,f.jsx)(B.C,{variant:eS,size:"sm",children:g.T.Staff}),t&&t.uri&&t.isStaffPicked&&(0,f.jsx)(Y.n,{href:"/watch",videoId:parseInt(e,10),userUri:t.uri,feature:"comments",marginRight:0}),(0,f.jsx)(v.xu,{children:(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(r),children:(0,f.jsx)(d.x,{variant:"body-sm",as:"span",whiteSpace:"nowrap",flexGrow:1,color:"text-primary",children:(0,Q.Zh)(new Date(r),{shorten:!0})})})}),(eg||ev||eh)&&(0,f.jsxs)(j.v,{onOpen:()=>{T?.(e,!!m,t?.id||"",!!i),ea(!0)},onClose:()=>ea(!1),children:[(0,f.jsx)(b.j,{as:k.h,"aria-label":"Options",icon:(0,f.jsx)(J.V,{}),variant:"minimal",size:"xs",ml:"auto",opacity:{base:1,md:es?1:0},_groupHover:{opacity:1},_focus:{opacity:1},"data-testid":"comment-menu-button"}),(0,f.jsxs)(x.q,{background:"background",minW:"169px",children:[eg?(0,f.jsx)(q.s,{onClick:()=>h(e),children:g.T.Edit}):null,ev?(0,f.jsx)(q.s,{onClick:()=>{O(e,t?.id||"",!!i,X,l),eb({duration:2e3,title:g.T.LinkCopied})},children:g.T.CopyLink}):null,ey?(0,f.jsx)(q.s,{onClick:()=>er(e.split("/").pop()),children:g.T.Report}):null,eh?(0,f.jsx)(q.s,{onClick:()=>y(e),children:g.T.Delete}):null]})]}),_&&!m&&F&&!et&&(0,f.jsx)(u.u,{placement:"top-end",label:el?g.T.ReOpen:g.T.MarkAsResolved,children:(0,f.jsx)(k.h,{"data-testid":"resolve","aria-label":"Comment status",variant:"minimal",size:"xs",icon:el?(0,f.jsx)(H.r,{}):(0,f.jsx)(G.n,{}),onFocus:e=>e.preventDefault(),opacity:{base:1,md:el?1:0},_groupHover:{opacity:1},_focus:{opacity:1},onClick:()=>A?.(e,_),ml:"-8px"})})]}),!U&&(0,f.jsxs)(v.xu,{children:[a&&(0,f.jsx)(B.C,{variant:"timestamp",size:"sm",mr:"8px",children:a}),S?(0,f.jsx)(eC,{text:l,editedTime:n,isResolved:el,searchQuery:ee}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.x,{display:"inline",variant:"body-md",children:l}),n&&(0,f.jsx)(u.u,{placement:"top",label:(0,Z.jF)(n),children:(0,f.jsx)(d.x,{display:"inline",color:"text-secondary",variant:"body-md",children:` (${g.T.Edited})`})})]}),Array.isArray(z)&&(0,f.jsx)(ei,{setPreviewClip:K,textDecorations:z})]}),em&&!et&&(0,f.jsx)(L.U,{spacing:50,children:(0,f.jsx)(p.z,{variant:"secondary",size:"xs",onClick:()=>w?.(e),children:g.T.Reply})})]})]})};var eE=r(435070);let eT=({isDeeplinkedComment:e=!1})=>{let t=(0,o.useRef)(null);return(0,o.useEffect)(()=>{if(!e)return;let r=setTimeout(()=>{t.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},500);return()=>clearTimeout(r)},[e]),(0,f.jsxs)(L.U,{spacing:75,align:"flex-start",px:{base:200,md:300},py:75,role:"group","data-testid":"comment",ref:e?t:null,children:[(0,f.jsx)(v.xu,{backgroundColor:"fill-component",boxSize:"sm",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",children:(0,f.jsx)(eE.N,{m:"4px",boxSize:"20px"})}),(0,f.jsx)(D.g,{spacing:75,minW:0,align:"stretch",flex:1,children:(0,f.jsx)(L.U,{spacing:75,children:(0,f.jsx)(N.n,{size:"md",color:"text-secondary",p:"6px 0",children:g.T.DeletedComment})})})]})};var eD=r(452590);let eN=({w:e="100%",h:t="2xs"})=>(0,f.jsx)(eD.O,{w:e,h:t,borderRadius:"pill",bgSize:"200%"}),e$=({w:e="md",h:t="md"})=>(0,f.jsx)(eD.O,{w:e,h:t,borderRadius:"round",bgSize:"200%"}),e_=({opacity:e="100%"})=>(0,f.jsxs)(L.U,{px:{base:200,md:300},py:100,align:"stretch",w:"100%",opacity:e,children:[(0,f.jsx)(e$,{}),(0,f.jsxs)(D.g,{spacing:75,flex:1,align:"stretch",children:[(0,f.jsx)(eN,{w:"90%"}),(0,f.jsx)(eN,{w:"100%"}),(0,f.jsx)(eN,{w:"70%"})]})]}),eL=()=>(0,f.jsxs)(D.g,{flexGrow:1,align:"stretch",spacing:75,pt:200,overflow:"hidden",w:"100%",h:"100%",children:[(0,f.jsx)(e_,{opacity:"100%"}),(0,f.jsx)(e_,{opacity:"100%"}),(0,f.jsx)(e_,{opacity:"80%"}),(0,f.jsx)(e_,{opacity:"40%"}),(0,f.jsx)(e_,{opacity:"20%"})]});var eA=r(929871),eF=r(173774),ez=r(662555);let eK=({errorMessage:e="",isPublic:t,onSubmit:r,editingText:n="",autoFocus:i=!1,onCancel:s,shouldShowCancel:a=!1,submitButtonText:l=g.T.SubmitComment,isLoading:c=!1,richCommentComponent:d,commentContextFields:u,setDraftText:m,isGuestModalActive:h=!1,isDisabled:y=!1})=>{let j=(0,o.useRef)(null),b=(0,o.useRef)({}),{0:x,1:O}=(0,o.useState)(!1),{0:w,1:C}=(0,o.useState)(n),P=()=>{O(!0),d&&b?.current?.focusEnd()},k=()=>{b?.current?.onSubmit?.(),r?.(w),m?.("")};(0,o.useEffect)(()=>{c&&C(""),c||n||e||(b?.current?.clearContent?.(),O(!1),b?.current?.removeFocus?.())},[c,e]);let R=()=>{m?.(a?"":w),O(!1),s?.()};return(0,eA.O)({enabled:!h,ref:j,handler:R}),(0,f.jsxs)(v.xu,{w:"100%",ref:j,children:[d?(0,f.jsx)(d,{autoFocus:i,richtext:w,isExpanded:x,isPublic:t,placeholder:g.T.InputPlaceholder,setCommentText:e=>C(e),onFocus:P,richtextAreaRef:b,commentContextFields:u,onSubmitComment:r,isPostCommentLoading:c,isDisabled:y}):(0,f.jsx)(eF.g,{w:"100%",mb:0,size:"sm",rows:x?3:1,onFocus:P,placeholder:g.T.InputPlaceholder,value:w,onChange:e=>C(e.target.value),autoFocus:i,resize:"none",isInvalid:!!e,onKeyDown:e=>{"Enter"!==e.key||(!e.shiftKey&&w.trim()?(e.preventDefault(),k(),e.target.blur()):e.shiftKey||e.preventDefault())}}),x?(0,f.jsxs)(L.U,{gap:"100",justifyContent:"space-between",alignItems:"center",children:[e?(0,f.jsx)(N.n,{size:"sm",color:"status-destructive-primary",py:8,children:e}):(0,f.jsx)(v.xu,{fontSize:12,opacity:.6,py:8,color:"text-tertiary",children:n?null:(0,ez.Iu)({singular:"Use @ to mention others",dictionary:{es:{singular:"Use @ para mencionar a otros"},"de-DE":{singular:"Verwende @, um andere zu erw\xe4hnen"},"fr-FR":{singular:"Utilisez @ pour mentionner d'autres personnes"},"ja-JP":{singular:"他のユーザーにコメントするには @ を使用します"},"ko-KR":{singular:"다른 사람을 언급하려면 @를 사용하세요."},"pt-BR":{singular:"Use @ para mencionar outros usu\xe1rios"}}})}),(0,f.jsxs)(L.U,{children:[a?(0,f.jsx)(p.z,{variant:"minimal",size:"sm",onClick:R,children:g.T.Cancel}):null,(0,f.jsx)(p.z,{variant:"primary",type:"submit",isLoading:c,size:"sm",zIndex:1,onClick:k,isDisabled:d?!b?.current?.commentLength():!w.trim(),children:(0,f.jsx)("span",{children:l})})]})]}):null]})},eM="40px",eU=({comment:e,isPublic:t,addReply:r,editComment:n,editReply:i,deleteComment:s,deleteReply:a,isSubmitTextLoading:c=!1,isDeleteLoading:u=!1,deeplinkedCommentId:m,isMoreCommentsLoading:h=!1,lastElementRef:y,onCopyClick:j,canAddComments:b=!0,richCommentComponent:x,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,replyError:k,editCommentError:R,editReplyError:I,onMomentPlay:S,toggleCommentStatus:D,canResolveComment:N,setPreviewClip:$,searchQuery:V,isGuestModalActive:B,isPreviousVersion:q=!1,onReportClick:J,videoPrivacy:H})=>{let{0:G,1:Y}=(0,o.useState)(!0),{0:Q,1:W}=(0,o.useState)(""),{0:X,1:ee}=(0,o.useState)(""),{0:et,1:er}=(0,o.useState)(""),{0:en,1:ei}=(0,o.useState)(""),[eo,es]=(0,_.dQ)("space",["200","300"]),{0:ea,1:el}=(0,o.useState)(""),ec=e.replies&&e.replies.length>0,ed=Q&&Q===e.id,eu=b&&!ed,ep=!!m&&e.id.includes(m),em=!!m&&e.replies?.some(e=>m&&e.id.includes(m)),eh=()=>{Q&&W(""),X&&ee("")},eg=e=>{ei(e)},ef=()=>{er(""),ei("")},ey=e=>{Q&&r(Q,e)},ev=e=>{X&&i(X,e)};(0,o.useEffect)(()=>{(ep||em)&&"number"==typeof e?.timeCode&&S(e.timeCode)},[e?.timeCode,ep,S,em]),(0,o.useEffect)(()=>{!u&&(et||en)&&ef()},[u]);let ej=X&&e.id===R?.errorCommentId?R.errorMessage:"",eb=Q&&e.id===k?.errorCommentId?k.errorMessage:"",ex=X&&(R||I)||Q&&k,eO=!!e.deletedOn;(0,o.useEffect)(()=>{c||ex||eh()},[c]);let ew={base:`calc(${eo} + ${eM})`,md:`calc(${es} + ${eM})`},eC=X===e.id;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.k,{ref:y||void 0,direction:"column",backgroundColor:ep||em?"fill-component":"transparent",_hover:{backgroundColor:"fill-secondary"},children:[eO?(0,f.jsx)(eT,{isDeeplinkedComment:ep}):(0,f.jsx)(eS,{id:e.id,user:e.user,createdTime:e.createdTime,text:e.text,timeCode:e.timeCode,formattedTimeCode:e.formattedTimeCode,replies:e.replies,isOwnComment:e.isOwnComment,isOwnVideo:e.isOwnVideo,activeReplyId:Q,editedTime:e.editedTime,onDeleteClick:e=>{er(e)},onCopyClick:j,onEditClick:e=>ee(e),onReplyClick:e=>W(e),isDeeplinkedComment:ep,isRichComment:e.isRichComment,canAddComments:b,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,status:e.status,toggleCommentStatus:D,canResolveComment:N,textDecorations:e.textDecorations,setPreviewClip:$,isBeingEdited:eC,onMomentPlay:S,searchQuery:V,isPreviousVersion:q,onReportClick:J,videoPrivacy:H,isPublic:t}),ed&&!ec||eC?(0,f.jsx)(v.xu,{ml:ew,pr:{base:200,md:300},pb:100,mt:X?"-8px":0,children:(0,f.jsx)(eK,{isLoading:c,isPublic:t,autoFocus:!0,onCancel:eh,onSubmit:X?e=>{X&&n(X,e)}:ey,editingText:X?e.text:ea,shouldShowCancel:eC,submitButtonText:X?g.T.SaveEdit:g.T.SubmitComment,richCommentComponent:x,setDraftText:el,commentContextFields:{commentId:X?(0,Z.Pd)(X):(0,Z.Pd)(e.id),isReply:!X,existingReplyCounts:e.replies?.length||0,isEdit:!!X,isTimeCoded:!!e.timeCode},errorMessage:X?ej:eb,isGuestModalActive:B})}):null,ec?(0,f.jsx)(L.U,{ml:ew,spacing:50,children:(0,f.jsx)(p.z,{onClick:()=>Y(e=>!e),size:"xs",rightIcon:(0,f.jsx)(C.W,{transform:`rotate(${G?180:0}deg)`,transition:"transform 0.3s ease"}),variant:"minimal",children:g.T.RepliesToggle(e.replies?.length??0)})}):null,(0,f.jsx)(E.M,{children:G&&ec?(0,f.jsxs)(l.k,{as:T.E.div,direction:"column",ml:ew,borderLeft:"1px solid",borderColor:"stroke","data-testid":"replies-container",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{type:"tween"}},exit:{opacity:0,height:0},overflow:"hidden",children:[e.replies?.map((r,n)=>{let i=!!(m&&r.id.substring(r.id.lastIndexOf("/")+1).includes(m)),s=r.id===I?.errorCommentId?I.errorMessage:"",a=X===r.id,l=n===(e.replies?.length??0)-1;return f.jsxs(o.Fragment,{children:[f.jsx(eS,{isDeeplinkedComment:i,id:r.id,user:r.user,createdTime:r.createdTime,text:r.text,isOwnComment:r.isOwnComment,isOwnVideo:r.isOwnVideo,editedTime:r.editedTime,isReply:!0,isRichComment:r.isRichComment,activeReplyId:Q,onEditClick:e=>ee(e),onDeleteClick:eg,onCopyClick:j,onOpenCommentOptionsClick:O,isUserProfileClickable:w,onUserProfileClick:P,status:e.status,canAddComments:b,textDecorations:r.textDecorations,setPreviewClip:$,isBeingEdited:a,onMomentPlay:S,parentCommentId:e.id,searchQuery:V,isPreviousVersion:q,onReportClick:J,videoPrivacy:H,isPublic:t}),ed&&ec&&l||a?f.jsx(v.xu,{pl:"8px",pr:{base:200,md:300},pb:100,children:f.jsx(eK,{isLoading:c,isPublic:t,autoFocus:!0,onCancel:eh,onSubmit:X?ev:ey,editingText:X?r.text:ea,setDraftText:el,shouldShowCancel:a,submitButtonText:X?g.T.SaveEdit:g.T.SubmitComment,commentContextFields:{commentId:Z.Pd(Q)??Z.Pd(e.id),isReply:!0,existingReplyCounts:e.replies?.length||0,isEdit:!!X},richCommentComponent:x,errorMessage:X?s:eb,isGuestModalActive:B})}):null]},r.id)}),eu&&!X&&!q&&(0,f.jsx)(L.U,{children:(0,f.jsx)(p.z,{variant:"secondary",size:"xs",mt:"4px",ml:"63px",mb:"8px",onClick:()=>W(e.id),children:g.T.Reply})})]}):null}),h&&(0,f.jsx)(eL,{})]},e.id),(0,f.jsxs)(A.u,{isOpen:!!et||!!en,onClose:ef,isCentered:!0,children:[(0,f.jsx)(F.Z,{}),(0,f.jsxs)(z.h,{width:"482px",maxWidth:"calc(100vw - 32px)",height:"180px",children:[(0,f.jsx)(K.x,{children:(0,f.jsx)(d.x,{variant:"body-xl",textAlign:"left",fontSize:"20px",children:g.T.ConfirmDelete})}),(0,f.jsx)(M.f,{}),(0,f.jsx)(U.m,{children:(0,f.jsxs)(L.U,{children:[(0,f.jsx)(p.z,{variant:"minimal",onClick:ef,children:g.T.Cancel}),(0,f.jsx)(p.z,{isLoading:u,variant:"destructive",onClick:et?()=>{s(et,!!e?.timeCode)}:()=>{a(en,!!e?.timeCode)},children:(0,f.jsx)("span",{children:g.T.Delete})})]})})]})]})]})};var eZ=r(980229);let eV=({isFilter:e,onClearClick:t})=>{let r=e?(0,f.jsx)(I.w,{boxSize:"lg"}):(0,f.jsx)(eZ.X,{boxSize:"lg"}),n=e?g.T.ClearFilters:g.T.DifferentSearch;return(0,f.jsxs)(D.g,{px:{base:200,md:300},flexGrow:1,align:"center",justify:"center","data-testid":"comments-no-match-placeholder",children:[r,(0,f.jsx)(d.x,{variant:"heading-md",color:"text-primary",children:g.T.NoMatchingResults}),(0,f.jsx)(d.x,{as:e?"u":"text",variant:"body-sm",fontSize:"14px",fontWeight:"350",cursor:e?"pointer":"default",color:"text-secondary",onClick:()=>{t?.()},children:n})]})};var eB=r(861671);let eq=({saveViewerCommentsSetting:e,canAddComments:t,hasComments:r,isPublic:n,hasOnlyCommentAccess:i,isPreviousVersion:o=!1})=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eB.$,{boxSize:r?"sm":"lg",color:"text-primary"}),(0,f.jsx)(d.x,{variant:"heading-xs",fontWeight:"350",textAlign:"center",color:"text-secondary",children:o?r?void 0:g.T.NoCollaboratorsComment:t?n?e?g.T.NoViewersCommentYet:g.T.NoComments:g.T.NoCollaboratorsCommentYet:e?g.T.ViewersCanNotPostNewComments:g.T.NoCommentsAllowed}),e&&!t&&!i&&(0,f.jsx)(p.z,{variant:"primary",size:r?"xs":"sm",onClick:()=>e(!t),children:g.T.AllowComments})]});var eJ=r(767269),eH=r(331427),eG=r(796805);let eY=({previewClip:e,onPlayerReady:t,height:r,width:n})=>{let i=(0,o.useRef)(null),{player:s}=(0,eG.Z)(i,(0,Z.Pd)(e.uri),!0,e.embedPlayerConfigUrl??"",!1);return(0,o.useEffect)(()=>{s?.ready&&s.ready(()=>{t(),s.play()})},[s,t]),(0,f.jsx)(v.xu,{position:"relative",height:(0,eJ.h)(r),width:(0,eJ.h)(n),children:(0,f.jsx)(v.xu,{ref:i,className:"player js-player"})})},eQ=({previewClip:e,setPreviewClip:t})=>{let{0:r,1:n}=(0,o.useState)(!1),{height:i,width:s}=eW(e.width/e.height);return(0,f.jsxs)(A.u,{isOpen:!!e,onClose:()=>t(null),size:"lg",children:[(0,f.jsx)(F.Z,{width:"100%",height:"100%"}),(0,f.jsx)(z.h,{borderRadius:"0",width:(0,eJ.h)(s),height:(0,eJ.h)(i),maxW:(0,eJ.h)(s),children:(0,f.jsxs)(M.f,{padding:"0",borderRadius:"0",children:[!r&&(0,f.jsx)(ee.M,{height:"100%",width:"100%",position:"absolute",borderRadius:"sm",overflow:"hidden",children:(0,f.jsx)(eH.$,{size:"lg"})}),(0,f.jsx)(eY,{previewClip:e,onPlayerReady:()=>n(!0),height:i,width:s})]})})]})},eW=e=>{let t,r;let n=window.innerWidth-72,i=window.innerHeight-72;if(e>1)t=(r=700>n?n:700)/e;else{let o=700>i?i:700,s=o*e;s>n?(r=n,t=o/s*n):(r=s,t=o)}return{height:t,width:r}},eX=({comments:e,isPublic:t,addReply:r,editComment:n,editReply:i,deleteComment:s,deleteReply:a,isCommentsLoading:c=!1,isSubmitTextLoading:d=!1,isDeleteLoading:u=!1,deeplinkedCommentId:p,isMoreCommentsLoading:m,canAddComments:h=!0,lastElementRef:y,onCopyClick:v,richCommentComponent:j,onOpenCommentOptionsClick:b,isUserProfileClickable:x,onUserProfileClick:O,commentsFetchingError:w=!1,editCommentError:C,editReplyError:P,replyError:k,onMomentPlay:R,toggleCommentStatus:I,canResolveComment:S,searchQuery:_,appliedFilter:L,clearFilters:A,saveViewerCommentsSetting:F,isGuestModalActive:z,hasOnlyCommentAccess:K,isPreviousVersion:M=!1,onReportClick:U,videoPrivacy:Z})=>{let{0:V,1:B}=(0,o.useState)();return c?(0,f.jsx)(eL,{}):w?(0,f.jsxs)(D.g,{flexGrow:1,align:"center",justify:"center","data-testid":"comments-error",children:[(0,f.jsx)($.o,{}),(0,f.jsx)(N.n,{color:"text-secondary",size:"md",children:g.T.CommentsLoadingError})]}):(!e||0===e.length)&&(_||L)?(0,f.jsx)(eV,{isFilter:!!L,onClearClick:L?A:void 0}):e&&0!==e.length?(0,f.jsxs)(l.k,{direction:"column",overflowX:"auto",flexGrow:1,py:50,"data-testid":"comments-list",children:[V&&(0,f.jsx)(eQ,{previewClip:V,setPreviewClip:B}),(0,f.jsx)(E.M,{children:e.map((o,l)=>{let c=e.length-1===l;return(0,f.jsx)(T.E.div,{animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"tween"},children:(0,f.jsx)(eU,{comment:o,isPublic:t,addReply:r,editComment:n,onCopyClick:v,editReply:i,deleteComment:s,deleteReply:a,isSubmitTextLoading:d,isDeleteLoading:u,deeplinkedCommentId:p,isMoreCommentsLoading:c&&m,lastElementRef:c?y:void 0,canAddComments:h,richCommentComponent:j,onOpenCommentOptionsClick:b,isUserProfileClickable:x,onUserProfileClick:O,editCommentError:C,editReplyError:P,replyError:k,onMomentPlay:R,toggleCommentStatus:I,canResolveComment:S,setPreviewClip:B,searchQuery:_,isGuestModalActive:z,isPreviousVersion:M,onReportClick:U,videoPrivacy:Z})},o.id)})})]}):(0,f.jsx)(D.g,{px:{base:200,md:300},flexGrow:1,align:"center",justify:"center","data-testid":"comments-placeholder",children:(0,f.jsx)(eq,{canAddComments:h,saveViewerCommentsSetting:F,hasComments:!1,isPublic:t,hasOnlyCommentAccess:K,isPreviousVersion:M})})},e0={commentId:-1,isReply:!1,existingReplyCounts:0},e1=({onSubmit:e,isLoading:t,isPublic:r,canAddComments:n=!0,hasComments:i,richCommentComponent:o,errorMessage:s="",saveViewerCommentsSetting:a,isGuestModalActive:l,hasOnlyCommentAccess:c,isPreviousVersion:d=!1})=>!n&&i?(0,f.jsx)(D.g,{p:200,align:"center",justify:"center",children:(0,f.jsx)(eq,{canAddComments:n,saveViewerCommentsSetting:a,hasComments:!0,isPublic:r,hasOnlyCommentAccess:c,isPreviousVersion:d})}):n?(0,f.jsx)(v.xu,{p:{base:200,md:"8px 16px"},children:(0,f.jsx)(eK,{richCommentComponent:o,isLoading:t,isPublic:r,onSubmit:e,commentContextFields:e0,errorMessage:s,isGuestModalActive:l,isDisabled:d})}):null;var e2=r(74873),e5=r(94741),e9=r(904174),e3=r(479879),e6=r(750042),e7=r(846211),e4=r(727926);let e8=["baseUrl","select","variables","where","query"];function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tr(e){let{baseUrl:t,select:r,variables:n,where:{albumId:i,videoId:o,commentId:s},query:a}=e,l=(0,e7.Z)(e,e8),c=await fetch(`${t}/albums/${i}/videos/${o}/comments/${s}/replies?${(0,e4.Ov)(a)}&fields=${r.map(e4.Rb).join(",")}`,tt(tt({},l),{},{method:"POST",body:JSON.stringify((0,e4.mH)(n))}));if(!c.ok)throw new e4.F7("A network error occurred",c.status,c);if(204===c.status)return null;if(!c.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let d=await c.json();return(0,e4.l_)(d)}var tn=r(296638),ti=r(458388);function to(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ts(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?to(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):to(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ta(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[s,a]=(0,e6.AC)();return[(0,o.useCallback)(async o=>{a({type:"REQUEST"});try{let s=await e(`/albums/${o.where.albumId}/videos/${o.where.videoId}/comments/${o.where.commentId}/replies${(0,e6.Y$)(o)}`,tr(ts(ts({},o),{},{baseUrl:t,headers:ts(ts({},o.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:s})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),s]}"true"===r(173656).env.STORYBOOK&&(0,e6.MR)(ta,{endpoint:"/albums/:albumId/videos/:videoId/comments/:commentId/replies",method:"POST"});let tl=["baseUrl","select","where","query"],tc=["baseUrl","select","variables","where","query"];function td(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?td(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):td(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tp(e){let{baseUrl:t,select:r,where:{videoId:n,commentId:i},query:o}=e,s=(0,e7.Z)(e,tl),a=await fetch(`${t}/videos/${n}/comments/${i}/replies?${(0,e4.Ov)(o)}&fields=${r.map(e4.Rb).join(",")}`,tu(tu({},s),{},{method:"GET"}));if(!a.ok)throw new e4.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e4.l_)(l)}async function tm(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:o},query:s}=e,a=(0,e7.Z)(e,tc),l=await fetch(`${t}/videos/${i}/comments/${o}/replies?${(0,e4.Ov)(s)}&fields=${r.map(e4.Rb).join(",")}`,tu(tu({},a),{},{method:"POST",body:JSON.stringify((0,e4.mH)(n))}));if(!l.ok)throw new e4.F7("A network error occurred",l.status,l);if(204===l.status)return null;if(!l.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let c=await l.json();return(0,e4.l_)(c)}var th=r(512959),tg=r(173656);let tf=["perPage","page"];function ty(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ty(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tj(){let{baseUrl:e,jwt:t,xVimeoPage:r,locale:n}=(0,ti.r)(),[i,s]=(0,e6.AC)();return[(0,o.useCallback)(async i=>{s({type:"REQUEST"});try{let o=await tm(tv(tv({},i),{},{baseUrl:e,headers:tv(tv({},i.headers),{},{"Content-Type":"application/json",Authorization:t?`jwt ${t}`:"","Vimeo-Page":`${r}`,"Accept-Language":n??"en"})}));s({type:"SUCCESS",payload:o})}catch(e){s({type:"FAILURE",payload:e})}},[e,r,t,n,s]),i]}"true"===tg.env.STORYBOOK&&(0,e6.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:o,locale:s}=(0,ti.r)();return(0,tn.ZP)(r?`/videos/${r.where.videoId}/comments/${r.where.commentId}/replies${(0,e6.Y$)(r)}`:()=>null,r?()=>tp(tv(tv({},r),{},{headers:tv(tv({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${o}`,"Accept-Language":s??"en"}),baseUrl:n})):null,t)},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e6.MR)(function(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[s,a]=(0,e6.AC)();return[(0,o.useCallback)(async o=>{a({type:"REQUEST"});try{let s=await e(`/videos/${o.where.videoId}/comments/${o.where.commentId}/replies${(0,e6.Y$)(o)}`,tp(tv(tv({},o),{},{baseUrl:t,headers:tv(tv({},o.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})));a({type:"SUCCESS",payload:s})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),s]},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e6.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:o,locale:s}=(0,ti.r)();return(0,th.ZP)((e,t)=>{if(null===r||t&&!t.paging.next)return null;let n=r.query??{},{perPage:i=25,page:o}=n,s=(0,e7.Z)(n,tf),a=r.select.join(","),l=Object.entries(s??{}).filter(([,e])=>void 0!==e).map(([e,t])=>`${e}=${t}`).join("&");return[`/videos/${r.where.videoId}/comments/${r.where.commentId}/replies?page=${e+1}&perPage=${i}&fields=${a}&${l}`,e]},null!==r?([e,t])=>tp(tv(tv({},r),{},{baseUrl:n,headers:tv(tv({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${o}`,"Accept-Language":s??"en"}),query:tv(tv({},r.query),{},{page:t+1})})):null,t)},{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"GET"}),"true"===tg.env.STORYBOOK&&(0,e6.MR)(tj,{endpoint:"/videos/:videoId/comments/:commentId/replies",method:"POST"});let tb=["baseUrl","select","where","query"],tx=["baseUrl","select","variables","where","query"];function tO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tO(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tO(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tC(e){let{baseUrl:t,select:r,where:{videoId:n,commentId:i},query:o}=e,s=(0,e7.Z)(e,tb),a=await fetch(`${t}/videos/${n}/private_comments/${i}/replies?${(0,e4.Ov)(o)}&fields=${r.map(e4.Rb).join(",")}`,tw(tw({},s),{},{method:"GET"}));if(!a.ok)throw new e4.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e4.l_)(l)}async function tP(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:o},query:s}=e,a=(0,e7.Z)(e,tx),l=await fetch(`${t}/videos/${i}/private_comments/${o}/replies?${(0,e4.Ov)(s)}&fields=${r.map(e4.Rb).join(",")}`,tw(tw({},a),{},{method:"POST",body:JSON.stringify((0,e4.mH)(n))}));if(!l.ok)throw new e4.F7("A network error occurred",l.status,l);if(204===l.status)return null;if(!l.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let c=await l.json();return(0,e4.l_)(c)}var tk=r(173656);let tR=["perPage","page"];function tI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tS(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tI(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tE(){let{baseUrl:e,jwt:t,xVimeoPage:r,locale:n}=(0,ti.r)(),[i,s]=(0,e6.AC)();return[(0,o.useCallback)(async i=>{s({type:"REQUEST"});try{let o=await tP(tS(tS({},i),{},{baseUrl:e,headers:tS(tS({},i.headers),{},{"Content-Type":"application/json",Authorization:t?`jwt ${t}`:"","Vimeo-Page":`${r}`,"Accept-Language":n??"en"})}));s({type:"SUCCESS",payload:o})}catch(e){s({type:"FAILURE",payload:e})}},[e,r,t,n,s]),i]}"true"===tk.env.STORYBOOK&&(0,e6.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:o,locale:s}=(0,ti.r)();return(0,tn.ZP)(r?`/videos/${r.where.videoId}/private_comments/${r.where.commentId}/replies${(0,e6.Y$)(r)}`:()=>null,r?()=>tC(tS(tS({},r),{},{headers:tS(tS({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${o}`,"Accept-Language":s??"en"}),baseUrl:n})):null,t)},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e6.MR)(function(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[s,a]=(0,e6.AC)();return[(0,o.useCallback)(async o=>{a({type:"REQUEST"});try{let s=await e(`/videos/${o.where.videoId}/private_comments/${o.where.commentId}/replies${(0,e6.Y$)(o)}`,tC(tS(tS({},o),{},{baseUrl:t,headers:tS(tS({},o.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})));a({type:"SUCCESS",payload:s})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),s]},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e6.MR)(function(e,t){let r="function"==typeof e?e():e,{baseUrl:n,jwt:i,xVimeoPage:o,locale:s}=(0,ti.r)();return(0,th.ZP)((e,t)=>{if(null===r||t&&!t.paging.next)return null;let n=r.query??{},{perPage:i=25,page:o}=n,s=(0,e7.Z)(n,tR),a=r.select.join(","),l=Object.entries(s??{}).filter(([,e])=>void 0!==e).map(([e,t])=>`${e}=${t}`).join("&");return[`/videos/${r.where.videoId}/private_comments/${r.where.commentId}/replies?page=${e+1}&perPage=${i}&fields=${a}&${l}`,e]},null!==r?([e,t])=>tC(tS(tS({},r),{},{baseUrl:n,headers:tS(tS({},r.headers),{},{"Content-Type":"application/json",Authorization:i?`jwt ${i}`:"","Vimeo-Page":`${o}`,"Accept-Language":s??"en"}),query:tS(tS({},r.query),{},{page:t+1})})):null,t)},{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"GET"}),"true"===tk.env.STORYBOOK&&(0,e6.MR)(tE,{endpoint:"/videos/:videoId/private_comments/:commentId/replies",method:"POST"});var tT=r(603306),tD=r(176617),tN=r(772425),t$=r(96127),t_=r(508159),tL=r(700683),tA=r(112298),tF=r(345449),tz=r(389649);function tK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tM(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tK(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tK(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var tU=r(261896),tZ=r(926334),tV=r(11422),tB=r(592063);function tq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tJ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tq(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tq(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let tH=["baseUrl","where","query"],tG=["baseUrl","select","variables","where","query"];function tY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function tQ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tY(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tY(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function tW(e){let{baseUrl:t,where:{videoId:r,commentId:n,replyId:i},query:o}=e,s=(0,e7.Z)(e,tH),a=await fetch(`${t}/videos/${r}/private_comments/${n}/replies/${i}?${(0,e4.Ov)(o)}`,tQ(tQ({},s),{},{method:"DELETE"}));if(!a.ok)throw new e4.F7("A network error occurred",a.status,a);if(204===a.status)return null;if(!a.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let l=await a.json();return(0,e4.l_)(l)}async function tX(e){let{baseUrl:t,select:r,variables:n,where:{videoId:i,commentId:o,replyId:s},query:a}=e,l=(0,e7.Z)(e,tG),c=await fetch(`${t}/videos/${i}/private_comments/${o}/replies/${s}?${(0,e4.Ov)(a)}&fields=${r.map(e4.Rb).join(",")}`,tQ(tQ({},l),{},{method:"PATCH",body:JSON.stringify((0,e4.mH)(n))}));if(!c.ok)throw new e4.F7("A network error occurred",c.status,c);if(204===c.status)return null;if(!c.headers.get("content-type")?.match(/^application\/(.+)?json$/))throw Error("Expected JSON response");let d=await c.json();return(0,e4.l_)(d)}var t0=r(173656);function t1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t1(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t1(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function t5(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[s,a]=(0,e6.AC)();return[(0,o.useCallback)(async o=>{a({type:"REQUEST"});try{let s=await e(`/videos/${o.where.videoId}/private_comments/${o.where.commentId}/replies/${o.where.replyId}${(0,e6.Y$)(o)}`,tW(t2(t2({},o),{},{baseUrl:t,headers:t2(t2({},o.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:s})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),s]}function t9(){let{mutate:e}=(0,tn.kY)(),{baseUrl:t,jwt:r,xVimeoPage:n,locale:i}=(0,ti.r)(),[s,a]=(0,e6.AC)();return[(0,o.useCallback)(async o=>{a({type:"REQUEST"});try{let s=await e(`/videos/${o.where.videoId}/private_comments/${o.where.commentId}/replies/${o.where.replyId}${(0,e6.Y$)(o)}`,tX(t2(t2({},o),{},{baseUrl:t,headers:t2(t2({},o.headers),{},{"Content-Type":"application/json",Authorization:r?`jwt ${r}`:"","Vimeo-Page":`${n}`,"Accept-Language":i??"en"})})),!1);a({type:"SUCCESS",payload:s})}catch(e){a({type:"FAILURE",payload:e})}},[t,n,r,i,a]),s]}function t3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t6(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t3(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}"true"===t0.env.STORYBOOK&&(0,e6.MR)(t5,{endpoint:"/videos/:videoId/private_comments/:commentId/replies/:replyId",method:"DELETE"}),"true"===t0.env.STORYBOOK&&(0,e6.MR)(t9,{endpoint:"/videos/:videoId/private_comments/:commentId/replies/:replyId",method:"PATCH"});var t7=r(103873);function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function t8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var re=r(777179),rt=r.n(re);let rr=(e,t,r)=>(0,o.useMemo)(()=>{if(e)return{filteredComments:t};let n=rt()(t),i=r&&r?.toLowerCase()||"",o=0;return{filteredComments:n?.filter(e=>{if(e.deletedOn&&e?.replies?.length===0)return!1;let t=!e.deletedOn&&t$.Or(i,e.text);t&&o++;let r=e.replies?.filter(e=>{let t=t$.Or(i,e.text);return t&&o++,t}),n=r&&r.length>0;return t||n}),matchCount:o}},[t,r,e]);var rn=r(981257),ri=r(574623);let ro=(e,t,r)=>{let[n,{loading:i,error:o}]=(0,ri.r)(),{mutate:s}=(0,tA.C)(e,t,r);return{saveViewerPageCommentPreference:async t=>n({where:{videoId:e},select:["page"],variables:{page:{comments:t}}}).then(()=>{s()}),loading:i,error:o}};function rs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}let ra=({children:e})=>{let t=(0,tF.l)(),r=(0,ti.r)(),{guestUser:n}=(0,o.useContext)(t_.hf),i=n?JSON.parse(n)?.guestUserJwt:null;return(0,f.jsx)(ti.G,{xVimeoPage:r.xVimeoPage,baseUrl:r.baseUrl,locale:r.locale,jwt:i&&!t?i:r.jwt,children:e})};var rl=r(304834);let rc=(e,t)=>{let[r,n]=(0,rl.Z)(t,e),{0:i,1:s}=(0,o.useState)(r);return[i,(0,o.useCallback)(e=>{s(e),n(e)},[n])]};var rd=r(47379),ru=r(228921),rp=r(22352),rm=r(567848);let rh=({isActive:e,setActive:t,isLoading:r,onShowClick:n})=>(0,f.jsxs)(A.u,{isOpen:e,onClose:()=>t(!1),isCentered:!0,size:"md",children:[(0,f.jsx)(F.Z,{}),(0,f.jsxs)(z.h,{children:[(0,f.jsx)(rm.o,{}),(0,f.jsx)(K.x,{children:(0,ez.Iu)({singular:"Show comments on the video page",dictionary:{es:{singular:"Mostrar los comentarios en la p\xe1gina del video"},"de-DE":{singular:"Kommentare auf der Videoseite anzeigen"},"fr-FR":{singular:"Afficher les commentaires sur la page de la vid\xe9o"},"ja-JP":{singular:"動画ページにコメントを表示"},"ko-KR":{singular:"동영상 페이지에 댓글 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios na p\xe1gina do v\xeddeo"},"zh-CN":{singular:"在视频页面上显示评论"}}})}),(0,f.jsx)(M.f,{children:(0,ez.Iu)({singular:"Comments will be turned on in Appearance settings, making them visible to viewers on the video page",dictionary:{es:{singular:"Los comentarios se activar\xe1n en la configuraci\xf3n de Apariencia, lo que los har\xe1 visibles para los espectadores en la p\xe1gina del video"},"de-DE":{singular:"Kommentare werden in den Darstellungseinstellungen aktiviert, sodass sie f\xfcr Zuschauende auf der Videoseite sichtbar sind"},"fr-FR":{singular:"Les commentaires seront activ\xe9s dans les param\xe8tres d'apparence, les rendant visibles pour les spectateurs sur la page de la vid\xe9o"},"ja-JP":{singular:"外観設定でコメントがオンになり、動画ページで視聴者にコメントが表示されるようになります"},"ko-KR":{singular:"모양 설정에서 댓글 기능을 활성화하면 동영상 페이지에서 뷰어가 댓글을 볼 수 있습니다."},"pt-BR":{singular:"Os coment\xe1rios ser\xe3o ativados nas configura\xe7\xf5es de Apar\xeancia, tornando-os vis\xedveis para os espectadores na p\xe1gina do v\xeddeo"},"zh-CN":{singular:"评论将在“外观”设置中开启，观众可以在视频页面上看到评论。"}}})}),(0,f.jsx)(U.m,{children:(0,f.jsxs)(L.U,{children:[(0,f.jsx)(p.z,{variant:"tertiary",onClick:()=>t(!1),children:(0,ez.Iu)({singular:"Cancel",dictionary:{es:{singular:"Cancelar"},"de-DE":{singular:"Abbrechen"},"fr-FR":{singular:"Annuler"},"ja-JP":{singular:"キャンセル"},"ko-KR":{singular:"취소"},"pt-BR":{singular:"Cancelar"},"zh-CN":{singular:"取消"}}})}),(0,f.jsx)(p.z,{variant:"primary",isLoading:r,onClick:()=>n(),children:(0,ez.Iu)({singular:"Show comments",dictionary:{es:{singular:"Mostrar los comentarios"},"de-DE":{singular:"Kommentare anzeigen"},"fr-FR":{singular:"Afficher les commentaires"},"ja-JP":{singular:"コメントを表示する"},"ko-KR":{singular:"소감 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios"}}})})]})})]})]});function rg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rg(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ry=(0,t_.qy)((n=({clipRequestId:e,clipId:t,isPublic:r,searchQuery:n="",onMomentPlay:i,analyticsProps:u,isUserProfileClickable:p=!0,saveViewerCommentsSetting:m,setSearchCommentCount:h,showCommentsHiddenAlert:g=!1,videoVersionUri:v,targetApiVersion:j,isPreviousVersion:b=!1,onReportClick:x,showcaseId:O,reviewId:w,showResolvedComments:C=!0})=>{let k=(0,s.pm)(),R=(0,tF.R)(),I=function(){let{0:e,1:t}=(0,o.useState)("");return(0,o.useEffect)(()=>{let e=document.querySelector('meta[name="bp-server-session-id"]');e?t(e.getAttribute("content")??""):t("")},[]),e}(),{videoData:E,videoDataLoading:T}=(0,tA.C)(e,O,w),[D,N]=rc({value:"newest",label:(0,ez.Iu)({singular:"Newest",dictionary:{es:{singular:"Los m\xe1s nuevos"},"de-DE":{singular:"Neueste"},"fr-FR":{singular:"Plus r\xe9centes"},"ja-JP":{singular:"新着順"},"ko-KR":{singular:"최신"},"pt-BR":{singular:"Mais recentes"},"zh-CN":{singular:"最新"}}}),type:"date",direction:"desc"},"comments-container-sort"),$={status:"open",userType:"everyone",mentionAndReplies:!1,videoVersionUri:v,targetApiVersion:j},{0:_,1:L}=(0,o.useState)($),{initialPage:A,initialPageLoading:F,deeplinkNoteId:z,deeplinkDataError:K}=(0,rn.wz)(e,r,D,O,w),M=(0,t$.YK)(),{comments:U,commentsLoading:Z,loadMoreComments:V,isLoadingMoreComments:B,isCommentsDone:q,page:J,copyComment:H,commentsError:G}=(0,tz.hb)(e,r,D,_,O,w),{changeCommentsCount:Y}=(0,e9.I2)(e,r,{videoVersionUri:v,targetApiVersion:j},O,w),{privacy:Q}=(0,tB.V)(e,O,w),{guestUser:W,modalState:{isActive:X}}=(0,o.useContext)(t_.hf),{filteredComments:ee,matchCount:et}=rr(!!(!n||Z||U&&0===U.length),U,n),er=!r||r&&Q?.comments!=="nobody",en=!r&&C,[ei,eo,es]=function(e,t){let{0:r,1:n}=(0,o.useState)(t||1),i=(0,o.useRef)(null);return[r,(0,o.useCallback)(t=>{e&&(i.current&&i.current.disconnect(),i.current=new IntersectionObserver(t=>{t[0].isIntersecting&&e&&n(e=>e+1)}),t&&i.current.observe(t))},[e]),n]}(!q&&!Z&&!B&&!n,J),{0:ea,1:el}=(0,o.useState)(M||z),ec=(0,ru.K)(),{value:ed,set:eu,remove:ep}=(0,e2.Z)(tN.bn,null,void 0,ec),em=()=>{k({status:"error",title:(0,ez.Iu)({singular:"Unable to delete comment",dictionary:{es:{singular:"No se pudo eliminar el comentario"},"de-DE":{singular:"Kommentar kann nicht gel\xf6scht werden"},"fr-FR":{singular:"Impossible de supprimer le commentaire"},"ja-JP":{singular:"コメントを削除できません"},"ko-KR":{singular:"소감을 삭제할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel excluir o coment\xe1rio"},"zh-CN":{singular:"无法删除评论"}}})})};(0,o.useEffect)(()=>{J>ei&&es(J),ei>J&&V(ei)},[J,V,ei,es]),(0,o.useEffect)(()=>{A&&A>0&&es(A)},[A,es]);let{setComments:eh}=(0,o.useContext)(e5.B);(0,o.useEffect)(()=>{!r&&U&&eh(U)},[U,r,eh]),(0,o.useEffect)(()=>{h&&h(et)},[h,et]);let{postComment:eg,postCommentLoading:ef,postCommentError:ey}=(0,e3.PU)(e,r,D,u,_,O,w),{deleteComment:ev,deleteCommentLoading:ej}=function(e,t,r,n,i,o,s,a){let{videoData:l}=(0,tA.C)(e,s,a);return(r?function(e,t,r,n,i,o,s){let[a,l]=(0,tZ.qM)(),[c,d]=(0,tU.m)(),{loading:u,error:p}=s?d:l,{privacy:m}=(0,tB.V)(e,s),{revalidateComments:h}=(0,tz.dD)(e,n,o,s),{revalidateCommentCount:g}=(0,e9.UC)(e,{shouldFetch:!0},s),f=(0,tF.R)(),y=(0,t$.D1)(e),v=(0,tT.l)(e),j=async t=>{await a(tJ({where:{videoId:e,commentId:(0,t$.Pd)(t)}},v?{query:{password:v}}:{})),x(t)},b=async t=>{if(!s)return;let r=(0,t$.BO)(s);await c(tJ({where:{albumId:s,videoId:e,commentId:(0,t$.Pd)(t)}},r?{query:{password:r}}:{})),x(t)},x=e=>{if(p&&!u&&t(),!u&&!p){if(i){let t=tJ(tJ({},i),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!1}});(0,tD.MO)(y,m?.view,!0,t,f,null,r?.uploader?.link)}h(),g()}};return{deleteComment:s?b:j,deleteCommentLoading:u,deleteCommentError:p}}:function(e,t,r,n,i,o,s,a){let[l,{loading:c,error:d}]=(0,tV.o)(),{privacy:u}=(0,tB.V)(e,void 0,a),{revalidateComments:p}=(0,tz.O_)(e,n,o,void 0,a),{revalidateCommentCount:m}=(0,e9.ih)(e,{shouldFetch:!0,videoVersionUri:o?.videoVersionUri,targetApiVersion:o?.targetApiVersion},a),h=(0,tF.R)(),g=(0,t$.D1)(e),f=(0,t$.AE)(a),y=(e,n)=>{if(d&&!c&&t(),!c&&!d){if(i){let t=tJ(tJ({},i),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!1}});(0,tD.MO)(g,u?.view,!1,t,h,n,r?.uploader?.link)}p(),m()}};return{deleteComment:async(t,r)=>{await l({where:{videoId:e,commentId:(0,t$.Pd)(t)},query:{reviewId:a,password:f}}),y(t,r)},deleteCommentLoading:c,deleteCommentError:d}})(e,t,l,n,i,o,s,a)}(e,em,r,D,u,_,O,w),{deleteReply:eb,deleteReplyLoading:ex}=(r?function(e,t,r,n,i,o){let s=(0,tF.R)(),a=(0,t$.D1)(e),{privacy:l}=(0,tB.V)(e,o),[c,d]=(0,tZ.qM)(),[u,p]=(0,tU.m)(),{loading:m,error:h}=o?p:d,{revalidateComments:g}=(0,tz.dD)(e,r,i,o),{revalidateCommentCount:f}=(0,e9.UC)(e,{shouldFetch:!0},o),y=(0,tT.l)(e),v=async t=>{await c(t6({where:{videoId:e,commentId:(0,t$.Pd)(t)}},y?{query:{password:y}}:{})),b(t)},j=async t=>{if(!o)return;let r=(0,t$.BO)(o);await u(t6({where:{albumId:o,videoId:e,commentId:(0,t$.Pd)(t)}},r?{query:{password:r}}:{})),b(t)},b=e=>{if(!m&&h&&t(),!m&&!h&&n){let t=t6(t6({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0}});(0,tD.MO)(a,l?.view,!0,t,s,null)}g(),f()};return{deleteReply:o?j:v,deleteReplyLoading:m,deleteReplyError:h}}:function(e,t,r,n,i,o,s){let a=(0,tF.R)(),l=(0,t$.D1)(e),{privacy:c}=(0,tB.V)(e,void 0,s),[d,{loading:u,error:p}]=t5(),{revalidateComments:m}=(0,tz.O_)(e,r,i,void 0,s),{revalidateCommentCount:h}=(0,e9.ih)(e,{shouldFetch:!0,videoVersionUri:i?.videoVersionUri,targetApiVersion:i?.targetApiVersion},s),g=(0,t$.AE)(s),f=(e,r)=>{if(!u&&p&&t(),!u&&!p){if(n){let t=t6(t6({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0}});(0,tD.MO)(l,c?.view,!1,t,a,r)}m(),h()}};return{deleteReply:async(t,r)=>{await d({where:{videoId:e,replyId:(0,t$.Pd)(t),commentId:(0,t$.b)(t)},query:{reviewId:s,password:g}}),f(t,r)},deleteReplyLoading:u,deleteReplyError:p}})(e,em,D,u,_,O,w),{resolveComment:eO,unresolveComment:ew,updateCommentText:eC,editCommentLoading:eP,editCommentError:ek}=(0,t7.us)(e,r,D,u,_,O,w),{patchReply:eR,patchReplyLoading:eI,patchReplyError:eS}=function(e,t,r,n,i,s,a){let{videoData:l}=(0,tA.C)(e,s,a);return(t?function(e,t,r,n,i,s){let a=(0,tF.R)(),l=(0,t$.D1)(e),{privacy:c}=(0,tB.V)(e,s),[d,u]=(0,tZ.kS)(),[p,m]=(0,tU.M)(),{loading:h,error:g}=s?m:u,{revalidateComments:f}=(0,tz.dD)(e,r,i,s),{0:y,1:v}=(0,o.useState)(null),j=(0,tT.l)(e),b=async(t,r)=>{v(t),await d(t8({where:{videoId:e,commentId:(0,t$.Pd)(t)},variables:{richtext:r},select:tN.dp},j?{query:{password:j}}:{})),O(t,r)},x=async(t,r)=>{if(!s)return;v(t);let n=(0,t$.BO)(s);await p(t8({where:{albumId:s,videoId:e,commentId:(0,t$.Pd)(t)},variables:{richtext:r},select:tN.dp},n?{query:{password:n}}:{})),O(t,r)},O=(e,r)=>{if(!h&&!g){if(n){let i=(0,t$.ZG)(r),o=t8(t8({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0,comment_length:r?.length,is_mention:i}});(0,tD.Or)(l,c?.view,!0,o,a,!1,t?.uploader?.link)}f(t=>t?.filter(e=>!!e).map(t=>t8(t8({},t),{},{data:t.data?.map(t=>t8(t8({},t),{},{replies:t.replies?.map(t=>t.uri===e?t8(t8({},t),{},{text:r}):t)}))})))}};return{patchReply:s?x:b,patchReplyLoading:h,patchReplyError:g?{errorMessage:(0,ez.Iu)({singular:"Unable to edit reply",dictionary:{es:{singular:"No se puede editar la respuesta"},"de-DE":{singular:"Bearbeitung der Antwort nicht m\xf6glich"},"fr-FR":{singular:"Impossible de modifier la r\xe9ponse"},"ja-JP":{singular:"返信を編集できません"},"ko-KR":{singular:"답글을 편집할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel editar a resposta"},"zh-CN":{singular:"无法编辑回复"}}}),errorCommentId:y}:null}}:function(e,t,r,n,i,s,a){let l=(0,tF.R)(),[c,{loading:d,error:u}]=t9(),{privacy:p}=(0,tB.V)(e,void 0,a),{revalidateComments:m}=(0,tz.O_)(e,r,i,void 0,a),{0:h,1:g}=(0,o.useState)(null),f=(0,t$.AE)(a),y=async(t,r)=>{g(t),await c({where:{videoId:e,commentId:(0,t$.b)(t),replyId:(0,t$.Pd)(t)},variables:{richtext:r},select:["text","richtext","uri","metadata.connections.user","createdTime","metadata","timeCode","userName"],query:{reviewId:a,password:f}}),j(t,r)},v=(0,t$.D1)(e),j=(e,r)=>{if(!d&&!u){if(n){let i=(0,t$.ZG)(r),o=t8(t8({},n),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!0,comment_length:r?.length,is_mention:i}});(0,tD.Or)(v,p?.view,!1,o,l,!1,t?.uploader?.link)}m(t=>t?.filter(e=>!!e).map(t=>t8(t8({},t),{},{data:t.data?.map(t=>t8(t8({},t),{},{replies:t.replies.map(t=>t.uri===e?t8(t8({},t),{},{text:r}):t)}))})))}};return{patchReply:y,patchReplyLoading:d,patchReplyError:u?{errorMessage:(0,ez.Iu)({singular:"Unable to edit reply",dictionary:{es:{singular:"No se puede editar la respuesta"},"de-DE":{singular:"Bearbeitung der Antwort nicht m\xf6glich"},"fr-FR":{singular:"Impossible de modifier la r\xe9ponse"},"ja-JP":{singular:"返信を編集できません"},"ko-KR":{singular:"답글을 편집할 수 없습니다."},"pt-BR":{singular:"N\xe3o foi poss\xedvel editar a resposta"},"zh-CN":{singular:"无法编辑回复"}}}),errorCommentId:h}:null}})(e,l,r,n,i,s,a)}(e,r,D,u,_,O,w),{postReply:eE,postReplyLoading:eT,postReplyError:eD}=(r?function(e,t,r,n,i){let s=(0,t$.D1)(e),{revalidateComments:a}=(0,tz.dD)(e,t,n,i),[l,c]=tj(),[d,u]=ta(),{data:p,loading:m,error:h}=i?u:c,{videoData:g}=(0,tA.C)(e,i),f=g?.privacy.view,y=(0,tF.l)(),{toggleGuestLoginModal:v,guestUser:j}=(0,o.useContext)(t_.hf),b=y||!!j,{toggleLoginModal:x,setRedirectUrl:O}=(0,tL.NK)(),w=(0,tT.l)(e),{0:C,1:P}=(0,o.useState)(null),k=async(t,r)=>{if(b||"unlisted"!==f){if(!b){O(window.location.pathname+window.location.search),x(!0);return}}else{v(!0);return}let n={richtext:t};if(P(r),i){let t=(0,t$.BO)(i);await d(tM({where:{albumId:i,videoId:e,commentId:(0,t$.Pd)(r)},select:tN.Fl,variables:n},t?{query:{password:t}}:{}))}else await l(tM({where:{videoId:e,commentId:(0,t$.Pd)(r)},select:tN.Fl,variables:n},w?{query:{password:w}}:{}))};return(0,o.useEffect)(()=>{if(!m&&!h&&p&&C){let e=Number((g?.uploader?.link||"").match(/user(\d+)/)?.[1]||0);a(t=>t?.filter(e=>!!e).map(t=>tM(tM({},t),{},{data:t.data?.map(t=>{if(t.uri===C){let n=t$.ZG(p.text||"");if(r){let i=tM(tM({},r),{},{commentContextFields:{comment_id:t$.Pd(p.uri),is_reply:!0,comment_owner_id:y?.user?.id??-1,comment_length:p.text.length,is_mention:n,existing_reply_counts:t.replies.length}});tD.TC(s,f,e,i,y)}t.replies=[...t.replies,p]}return t}),total:t.total?t.total+1:0}))),P(null)}},[p,m,a,C,h,g?.uploader?.link,g?.privacy.view,s,y,r,f]),{postReply:k,postReplyLoading:m,postReplyError:h?{errorMessage:(0,ez.Iu)({singular:"Unable to post reply",dictionary:{es:{singular:"No se pudo publicar la respuesta"},"de-DE":{singular:"Es ist nicht m\xf6glich, eine Antwort zu hinterlassen"},"fr-FR":{singular:"Impossible de R\xe9pondre \xe0 un commentaire"},"ja-JP":{singular:"返信を投稿できませんでした"},"ko-KR":{singular:"답글 추가 불가"},"pt-BR":{singular:"N\xe3o Foi Poss\xedvel Postar Uma Resposta"},"zh-CN":{singular:"无法发布回复"}}}),errorCommentId:C}:null}}:function(e,t,r,n,i,s){let a=(0,tF.l)(),l=(0,t$.D1)(e),{0:c,1:d}=(0,o.useState)(null),[u,{data:p,loading:m,error:h}]=tE(),{revalidateComments:g}=(0,tz.O_)(e,t,n,void 0,s),{videoData:f}=(0,tA.C)(e,void 0,s),{toggleGuestLoginModal:y,guestUser:v}=(0,o.useContext)(t_.hf),j=a||!!v,b=(0,t$.AE)(s),x=v?JSON.parse(v)?.guestUserName:null,O=v?JSON.parse(v)?.guestUserId:null,w=async(t,r,n)=>{if(!j){y(!0);return}let i=n||a?.user?.name||x;d(r),await u({where:{videoId:e,commentId:(0,t$.Pd)(r)},select:["text","richtext","uri","metadata.connections.user","createdTime","metadata","timeCode","userName"],variables:{richtext:t,name:i,guestUserId:O},query:{reviewId:s,password:b}})};return(0,o.useEffect)(()=>{if(!m&&!h&&p&&c){let e=Number((f?.uploader?.link||"").match(/user(\d+)/)?.[1]||0),t=f?.privacy.view;g(n=>n?.filter(e=>!!e).map(n=>tM(tM({},n),{},{data:n.data?.map(n=>{if(n.uri===c){if(r){let i=t$.ZG(p?.richtext||p?.text||""),o=tM(tM({},r),{},{commentContextFields:{comment_id:t$.Pd(p.uri),is_reply:!0,comment_owner_id:a?.user?.id??-1,comment_length:p.text.length,is_mention:i,existing_reply_counts:n.replies.length}});tD.TC(l,t,e,o,a,!1,!1)}n.replies=[...n.replies,p],"closed"===n.status&&(n.status="open")}return n}),total:n.total?n.total+1:0}))),d(null)}},[p,h,m,g,c,f?.uploader?.link,f?.privacy.view,l,a,r]),{postReply:w,postReplyLoading:m,postReplyError:h?{errorMessage:(0,ez.Iu)({singular:"Unable to post reply",dictionary:{es:{singular:"No se pudo publicar la respuesta"},"de-DE":{singular:"Es ist nicht m\xf6glich, eine Antwort zu hinterlassen"},"fr-FR":{singular:"Impossible de R\xe9pondre \xe0 un commentaire"},"ja-JP":{singular:"返信を投稿できませんでした"},"ko-KR":{singular:"답글 추가 불가"},"pt-BR":{singular:"N\xe3o Foi Poss\xedvel Postar Uma Resposta"},"zh-CN":{singular:"无法发布回复"}}}),errorCommentId:c}:null}})(e,D,u,_,O,w),eN=(0,o.useCallback)(t=>(0,f.jsx)(rp.b,rf(rf({clipRequestId:e},t),{},{analyticsProps:u,showcaseId:O,reviewId:w})),[e,u,T,W]),{canEdit:e$}=(0,rd.Q)(e,O,w),e_=e=>{es(1),L(rf(rf({},_),e))};(0,o.useEffect)(()=>{let e=JSON.parse(ed);(R?.user||W)&&e?.text&&!T&&!ef&&!eT&&(ep(),(e.isReply?eE(e.text,e.commentId):eg(e.text)).then(()=>Y?.increaseCommentsCount()))},[R?.user,r,T,ef,eT,W]);let{0:eL,1:eA}=(0,o.useState)(!1),{saveViewerPageCommentPreference:eF,loading:eK}=ro(e,O,w),eM=(0,o.useRef)(""),eU=E&&E.page&&!E.page.comments,eZ=!E?.metadata?.interactions?.edit?.uri&&E?.metadata?.interactions?.canComment;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.k,{justifyContent:en?"space-between":"flex-end",px:{base:200,md:300},py:"8px",children:[en&&(0,f.jsx)(y,{showResolved:_?.status!=="open",updateFilterOptions:e=>{e_(e),u&&(0,tD.kp)(!e.status,t,Q?.view,u,R)}}),(0,f.jsxs)(l.k,{children:[(0,f.jsx)(P,{defaultSort:D.label,isPublic:r,setSort:e=>{N(e)},onSortSelect:e=>{u&&(0,tD.WR)(e.value,t,Q?.view,E?.uploader.link,r,u,R)}}),(0,f.jsx)(S,{filterOptions:_,updateFilterOptions:e=>{u&&(0,tD._x)(t$.Xg[e.userType??"mentions_replies"].option,t$.Xg[e.userType??"mentions_replies"].copy,t,r,Q?.view,u,R),e_(e)},isLoggedOut:!R?.user})]})]}),b&&(0,f.jsx)(l.k,{px:{base:200,md:300},children:(0,f.jsx)(c.bZ,{display:"flex",alignItems:"center",status:"info",size:"sm",children:(0,f.jsx)(d.x,{variant:"body-xl",fontSize:"body-sm",letterSpacing:"0.24px",children:(0,ez.Iu)({singular:"To add a comment, {LINK}view the current version{/LINK}",replacements:{LINK:t=>(0,f.jsx)(a.r,{fontSize:"body-sm",variant:"inline-primary",href:w?`/reviews/${w}/videos/${e}`:`/manage/videos/${e}`,_hover:{cursor:"pointer"},children:t})},dictionary:{es:{singular:"Para agregar un comentario, {LINK}ver la versi\xf3n actual{/LINK}"},"de-DE":{singular:"Um einen Kommentar hinzuzuf\xfcgen, {LINK}sehen Sie sich die aktuelle Version an{/LINK}"},"fr-FR":{singular:"Pour ajouter un commentaire, {LINK}consultez la version actuelle{/LINK}"},"ja-JP":{singular:"コメントを追加するには、{LINK}現在のバージョンを表示します{/LINK}"},"ko-KR":{singular:"댓글을 추가하려면 {LINK}현재 버전을 확인하세요{/LINK}."},"pt-BR":{singular:"Para adicionar um coment\xe1rio, {LINK}visualize a vers\xe3o atual{/LINK}"},"zh-CN":{singular:"要添加评论，请{LINK}查看当前版本{/LINK}"}}})})})}),r&&eU&&g&&!b&&(0,f.jsx)(l.k,{px:{base:200,md:300},children:(0,f.jsx)(c.bZ,{status:"info",children:(0,f.jsxs)(d.x,{variant:"body-xl",display:"inline",fontSize:"body-sm",children:[(0,ez.Iu)({singular:"Viewer comments are currently hidden on the video page.",dictionary:{es:{singular:"En este momento, los comentarios de los espectadores est\xe1n ocultos en la p\xe1gina del video."},"de-DE":{singular:"Kommentare der Zuschauenden sind derzeit auf der Videoseite verborgen."},"fr-FR":{singular:"Les commentaires des spectateurs sont actuellement masqu\xe9s sur la page de la vid\xe9o."},"ja-JP":{singular:"視聴者のコメントは現在、動画ページで非表示になっています。"},"ko-KR":{singular:"현재 동영상 페이지에서 뷰어 댓글이 숨김 상태로 설정되어 있습니다."},"pt-BR":{singular:"No momento, os coment\xe1rios dos espectadores est\xe3o ocultos na p\xe1gina do v\xeddeo."},"zh-CN":{singular:"目前视频页面上的观众评论被隐藏。"}}}),(0,f.jsx)(a.r,{fontSize:"body-sm",variant:"inline-primary",onClick:()=>eA(!0),pl:"4px",_hover:{cursor:"pointer"},children:(0,ez.Iu)({singular:"Show comments",dictionary:{es:{singular:"Mostrar los comentarios"},"de-DE":{singular:"Kommentare anzeigen"},"fr-FR":{singular:"Afficher les commentaires"},"ja-JP":{singular:"コメントを表示する"},"ko-KR":{singular:"소감 표시"},"pt-BR":{singular:"Mostrar coment\xe1rios"}}})})]})})}),(0,f.jsx)(eX,{comments:ee,toggleCommentStatus:(e,t)=>{"closed"===t?ew(e):eO(e)},isPublic:r,addReply:(e,t,r)=>{let n=(0,t$.uv)(t);R?.user||W||eu(JSON.stringify({text:n,isReply:!0,commentId:e,name:r})),eE(n,e,r).then(()=>Y?.increaseCommentsCount()),el(null)},deleteComment:(e,t)=>{ev(e,t),el(null)},deleteReply:(e,t)=>{eb(e,t),el(null)},editComment:(e,t)=>{eC(e,(0,t$.uv)(t)),el(null)},editReply:(e,t)=>{eR(e,(0,t$.uv)(t)),el(null)},lastElementRef:eo,canAddComments:er,deeplinkedCommentId:ea?.toString(),isCommentsLoading:Z||F,isSubmitTextLoading:eT||eP||eI,isDeleteLoading:ej||ex,isMoreCommentsLoading:B||!1,richCommentComponent:eN,onCopyClick:(e,n,i,o,s)=>{H(e,o);let a=(0,t$.ZG)(s);u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:!!o,comment_owner_id:(0,t$.Pd)(n),is_mention:a}}),(0,tD.xH)(t,Q?.view,E?.uploader.link,r,u,R,i))},onOpenCommentOptionsClick:(e,n,i,o)=>{u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:n,comment_owner_id:(0,t$.Pd)(i)}}),(0,tD.OD)(t,Q?.view,E?.uploader.link,r,u,R,o))},isUserProfileClickable:p,onUserProfileClick:(e,r,n)=>{u&&(u=rf(rf({},u),{},{commentContextFields:{comment_id:(0,t$.Pd)(e),is_reply:r,comment_owner_id:(0,t$.Pd)(n)}}),(0,tD.lo)(t,I,u,R))},commentsFetchingError:G||K,editCommentError:ek,editReplyError:eS,replyError:eD,onMomentPlay:i,canResolveComment:e$&&C,searchQuery:n,appliedFilter:_?.userType!=="everyone"||_?.mentionAndReplies===!0,clearFilters:()=>{e_($)},saveViewerCommentsSetting:m,isGuestModalActive:X,hasOnlyCommentAccess:eZ,isPreviousVersion:b,onReportClick:x,videoPrivacy:Q?.view}),(0,f.jsx)(e1,{richCommentComponent:eN,isLoading:ef,isPublic:r,onSubmit:e=>{let t=(0,t$.uv)(e);R?.user||W||eu(JSON.stringify({text:t,isReply:!1})),eg(t).then(()=>Y?.increaseCommentsCount()),el(null)},canAddComments:er,hasComments:!!U?.length,errorMessage:ey?.errorMessage,saveViewerCommentsSetting:m,isGuestModalActive:X,hasOnlyCommentAccess:eZ,isPreviousVersion:b}),(0,f.jsx)(rh,{isActive:eL,setActive:eA,isLoading:eK,onShowClick:()=>{eF(!0).then(()=>{eA(!1),eM.current=k({title:(0,ez.Iu)({singular:"Comments turned on in Appearance settings. {LINK}Undo{/LINK}",replacements:{LINK:e=>(0,f.jsx)(a.r,{color:"inherit",_hover:{cursor:"pointer",_dark:{color:"inherit"}},onClick:()=>{k.close(eM.current),eF(!1)},fontSize:"body-md",variant:"inline-primary",children:e})},dictionary:{es:{singular:"Los comentarios est\xe1n activados en la configuraci\xf3n de Apariencia. {LINK}Deshacer{/LINK}"},"de-DE":{singular:"Kommentare wurden in den Auftrittseinstellungen aktiviert. {LINK}R\xfcckg\xe4ngig machen{/LINK}"},"fr-FR":{singular:"Commentaires activ\xe9s dans les param\xe8tres d'apparence. {LINK}Annuler{/LINK}"},"ja-JP":{singular:"外観設定でコメントがオンになっています。{LINK}元に戻す{/LINK}"},"ko-KR":{singular:"모양 설정에서 댓글이 활성화되었습니다. {LINK}실행 취소{/LINK}"},"pt-BR":{singular:"Coment\xe1rios ativados nas configura\xe7\xf5es de Apar\xeancia. {LINK}Desfazer{/LINK}"},"zh-CN":{singular:"在外观设置中启用了评论。{LINK}撤销{/LINK}"}}}),duration:3e3})}).catch(()=>{k({title:(0,ez.Iu)({singular:"Unable to turn on comments. {LINK}Try again{/LINK}",replacements:{LINK:e=>(0,f.jsx)(a.r,{color:"inherit",onClick:()=>eA(!0),_hover:{cursor:"pointer",_dark:{color:"inherit"}},fontSize:"body-md",variant:"inline-primary",children:e})},dictionary:{es:{singular:"No se pueden activar los comentarios. {LINK}Vuelva a intentarlo{/LINK}"},"de-DE":{singular:"Kommentare k\xf6nnen nicht aktiviert werden. {LINK}Erneut versuchen{/LINK}"},"fr-FR":{singular:"Impossible d'activer les commentaires. {LINK}R\xe9essayez{/LINK}"},"ja-JP":{singular:"コメントをオンにできませんでした。{LINK}もう一度お試しください{/LINK}"},"ko-KR":{singular:"댓글을 활성화할 수 없습니다. {LINK}다시 시도하세요.{/LINK}"},"pt-BR":{singular:"N\xe3o foi poss\xedvel ativar os coment\xe1rios. {LINK}Tente novamente{/LINK}"},"zh-CN":{singular:"无法开启评论。{LINK}请重试{/LINK}"}}}),duration:3e3})})}})]})},e=>(0,f.jsx)(ra,{children:(0,f.jsx)(n,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e))})))},981257:function(e,t,r){r.d(t,{wz:function(){return c}});var n=r(652983),i=r(1945),o=r(509738),s=r(370966),a=r(603306),l=r(96127);function c(e,t,r,c,d){let u=(0,l.vh)(),p=function(e,t,r,s,c){let{0:d,1:u}=(0,n.useState)(!1),p=(0,o.gV)(()=>{if(d||!t||!s?.shouldFetch||c)return null;let n=(0,a.l)(e);return{query:(0,l.KK)(t,n,r),where:{videoId:e},select:["uri"]}}),m=(0,i.bG)(()=>{if(d||!t||!s?.shouldFetch||!c)return null;let n=(0,l.BO)(c);return{query:(0,l.KK)(t,n,r),where:{albumId:c,videoId:e},select:["uri"]}}),{data:h,error:g}=c?m:p;(0,n.useEffect)(()=>{h&&!d&&(u(!0),f.current=h.page)},[h,d]);let f=(0,n.useRef)(h?.page);return t?{initialPage:f.current,initialPageLoading:!d,deeplinkNoteId:t,deeplinkDataError:g}:{initialPage:1,initialPageLoading:!1,deeplinkNoteId:null,deeplinkDataError:!1}}(e,u,r,{shouldFetch:t},c),m=function(e,t,r,i,o){let{0:a,1:c}=(0,n.useState)(!1),d=(0,l.AE)(o),{data:u,error:p}=(0,s.cz)(()=>!a&&t&&i?.shouldFetch?{query:{noteId:t,sort:r?.type,direction:r?.direction,includeDeletedComments:!0,status:"open",reviewId:o,password:d},where:{videoId:e},select:["uri"]}:null);(0,n.useEffect)(()=>{u&&!a&&(c(!0),m.current=u.page)},[u,a]);let m=(0,n.useRef)(u?.page);return t?{initialPage:m.current,initialPageLoading:!a,deeplinkNoteId:t,deeplinkDataError:p}:{initialPage:1,initialPageLoading:!1,deeplinkNoteId:null,deeplinkDataError:!1}}(e,u,r,{shouldFetch:!t},d);return t?p:m}},655167:function(e,t,r){r.d(t,{n:function(){return R}});var n=r(706138),i=r(846211),o=r(652983),s=r(844578),a=r(670296),l=r(751004),c=r(662555),d=r(397458);let u=()=>(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 32 32",children:(0,d.jsx)("g",{children:(0,d.jsx)("g",{id:"staffpicks_layer_1",children:(0,d.jsxs)("g",{children:[(0,d.jsx)("circle",{cx:"16",cy:"16",r:"16"}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-1",d:"M20.47,9.32h-3.81v13.35h1.91v-5.72h1.91c1.05,0,1.91-.85,1.91-1.91v-3.81c0-1.05-.85-1.91-1.91-1.91ZM18.57,15.05h1.91v-3.81h-1.91v3.81Z"}),(0,d.jsx)("path",{className:"path-1",d:"M15.39,13.14v-1.91c0-1.05-.85-1.91-1.91-1.91h-1.91c-1.05,0-1.91.85-1.91,1.91v3.81c0,1.05.85,1.91,1.91,1.91h1.91v3.81h-1.91v-1.91h-1.91v1.91c0,1.05.85,1.91,1.91,1.91h1.91c1.05,0,1.91-.85,1.91-1.91v-3.81c0-1.05-.85-1.91-1.91-1.91h-1.91v-3.81h1.91v1.91h1.91Z"})]}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-2",d:"M5.18,14.92c-.49.37-.94.8-1.38,1.28-.45-.46-.88-.98-1.27-1.54.1-1.04.32-2.06.66-3.05.25.64.54,1.24.88,1.79.53-.37,1.08-.67,1.64-.93-.27.79-.45,1.61-.53,2.45Z"}),(0,d.jsx)("path",{className:"path-2",d:"M5.4,18.42c-.35.51-.65,1.06-.91,1.65-.58-.29-1.15-.65-1.69-1.06-.23-1.02-.34-2.06-.34-3.1.45.52.91,1,1.41,1.42.39-.51.82-.98,1.26-1.4,0,.84.09,1.68.27,2.49Z"}),(0,d.jsx)("path",{className:"path-2",d:"M6.72,21.66c-.16.59-.27,1.21-.33,1.85-.64-.09-1.29-.25-1.94-.46-.55-.89-.99-1.84-1.32-2.83.59.36,1.18.65,1.79.89.21-.61.46-1.19.75-1.73.26.79.62,1.56,1.06,2.27Z"}),(0,d.jsx)("path",{className:"path-2",d:"M9,24.32c.04.61.13,1.23.27,1.87-.63.11-1.3.17-1.99.17-.8-.67-1.52-1.43-2.14-2.27.67.15,1.33.24,1.97.28,0-.65.05-1.27.16-1.88.5.67,1.08,1.29,1.72,1.83Z"}),(0,d.jsx)("path",{className:"path-2",d:"M6.08,11.54c-.58.2-1.15.46-1.72.77-.28-.58-.52-1.21-.71-1.86.43-.95.97-1.85,1.6-2.68.03.68.12,1.34.26,1.98.62-.18,1.24-.3,1.85-.35-.51.66-.94,1.39-1.29,2.15Z"}),(0,d.jsx)("path",{className:"path-1",d:"M7.02,6.59c-.37.73-.67,1.47-.88,2.21.64-.43,1.32-.77,1.98-1.05.31-.66.69-1.3,1.15-1.93-.75.19-1.5.44-2.25.78Z"})]}),(0,d.jsxs)("g",{children:[(0,d.jsx)("path",{className:"path-2",d:"M29.47,14.66c-.38.56-.82,1.08-1.27,1.54-.44-.48-.89-.9-1.38-1.28-.08-.83-.26-1.66-.53-2.45.55.25,1.11.56,1.64.93.34-.55.63-1.15.88-1.79.34.99.56,2.01.66,3.05Z"}),(0,d.jsx)("path",{className:"path-2",d:"M29.2,19.01c-.54.41-1.11.76-1.69,1.06-.26-.59-.56-1.14-.91-1.65.19-.82.28-1.65.27-2.49.44.42.87.88,1.26,1.4.5-.42.96-.89,1.41-1.42,0,1.04-.11,2.08-.34,3.1Z"}),(0,d.jsx)("path",{className:"path-2",d:"M27.55,23.05c-.65.21-1.3.37-1.94.46-.06-.64-.17-1.26-.33-1.85.44-.71.79-1.48,1.06-2.27.28.53.54,1.11.75,1.73.6-.24,1.19-.54,1.79-.89-.33.99-.77,1.94-1.32,2.83Z"}),(0,d.jsx)("path",{className:"path-2",d:"M24.71,26.36c-.69,0-1.35-.07-1.99-.17.14-.64.23-1.26.27-1.87.64-.54,1.22-1.15,1.72-1.83.11.6.16,1.23.16,1.88.64-.04,1.31-.13,1.97-.28-.62.84-1.34,1.6-2.14,2.27Z"}),(0,d.jsx)("path",{className:"path-2",d:"M28.35,10.45c-.19.66-.43,1.28-.71,1.86-.57-.31-1.14-.57-1.72-.77-.34-.76-.78-1.49-1.29-2.15.61.06,1.23.18,1.85.35.14-.63.23-1.3.26-1.98.63.83,1.17,1.73,1.6,2.68Z"}),(0,d.jsx)("path",{className:"path-1",d:"M23.87,7.75c.67.28,1.34.63,1.98,1.05-.21-.74-.51-1.48-.88-2.21-.75-.34-1.5-.59-2.25-.78.45.63.84,1.28,1.15,1.93Z"})]})]})})})});var p=r(385459),m=r(329806),h=r(490055),g=r(60266),f=r(841433),y=r(695426),v=r(724515);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let x=()=>({pageName:"viewer_home",videoPrivacy:"public",isTeamMember:!1,teamOwnerId:null});function O(e){var t;let r="view"===e.event?"vimeo.view_sp_badge":"vimeo.select_sp_badge",n="click"===e.event?(0,m.kD)({action_type:"click",feature:null}):(0,p.Mw)({view_type:"impression",feature:null}),{videoId:i,userUri:o,feature:s,location:a,videoPrivacy:l,sessionId:c,pageName:d,isTeamMember:u,teamOwnerId:j}=b(b({},x()),e),O=parseInt(o?.split("/")[2]??0,10);(0,v.Ou)(r,b(b(b(b(b(b({},n),(0,h.Qt)({video_id:i,video_owner_id:O,video_privacy:l})),(0,h.Qt)({video_id:i,viewer_home_session_id:c})),function(e,t=null,r=null){return(0,g.g9)({page_name:e,referrer_page_name:t,path:window.location.pathname,referrer:r})}(d)),(0,f.UW)({is_team_member:u,team_owner_id:j})),(t="viewer_home",(0,y.FI)({product:t,feature:s,location:a,modal_name:null,flow:null,element:null,copy:"sp",device_type:null,entity_type:"user"}))),1)}let w=["href","onClick","children"];function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let k=e=>{let{href:t,onClick:r,children:n}=e,o=(0,i.Z)(e,w);return t||r?(0,d.jsx)("a",P(P({style:{display:"inline-flex"},href:t,onClick:r,target:"_blank",rel:"noreferrer"},o),{},{children:n})):(0,d.jsx)(d.Fragment,{children:n})};function R({radius:e,href:t,videoId:r,userUri:n,feature:i,onClick:p,marginRight:m=8}){let h=function(){let{0:e,1:t}=(0,o.useState)("");return(0,o.useEffect)(()=>{let e=document.querySelector('meta[name="bp-server-session-id"]');e?t(e.getAttribute("content")??""):t("")},[]),parseInt(e,10)}(),g="profile"===i?"video_details_panel":"comments_panel",f={videoId:r,userUri:n,sessionId:h,feature:i,location:g};(0,o.useEffect)(()=>{O(P({event:"view"},{videoId:r,userUri:n,sessionId:h,feature:i,location:g}))},[r,n,h,i,g]);let y=(0,s.ff)("#000000","#FFFFFF"),v=(0,s.ff)("#FFFFFF","#000000");return(0,d.jsx)(a.u,{label:(0,c.Iu)({singular:"View Staff Picks",dictionary:{es:{singular:"Ver Staff Picks"},"de-DE":{singular:"Staff Picks anzeigen"},"fr-FR":{singular:"Voir les Staff Picks"},"ja-JP":{singular:"スタッフピックを表示"},"ko-KR":{singular:"스태프 픽 보기"},"pt-BR":{singular:"Ver Staff Picks"},"zh-CN":{singular:"查看 Staff Picks"}}}),placement:"top",children:(0,d.jsx)(l.xu,{display:"inline-flex",alignSelf:"center",marginRight:m,sx:{"& svg":{width:`${e??18}`,height:`${e??18}`},"& circle":{fill:`${y}`},"& .path-1":{fillRule:"evenodd"},"& .path-1,& .path-2":{fill:`${v}`}},children:(0,d.jsx)(k,{href:t,onClick:()=>{O(P({event:"click"},f)),p&&p()},"aria-label":(0,c.Iu)({singular:"View Staff Picks",dictionary:{es:{singular:"Ver Staff Picks"},"de-DE":{singular:"Staff Picks anzeigen"},"fr-FR":{singular:"Voir les Staff Picks"},"ja-JP":{singular:"スタッフピックを表示"},"ko-KR":{singular:"스태프 픽 보기"},"pt-BR":{singular:"Ver Staff Picks"},"zh-CN":{singular:"查看 Staff Picks"}}}),children:(0,d.jsx)(u,{})})})})}}}]);
//# sourceMappingURL=15632-a54e2b5dbe00fa4e.js.map